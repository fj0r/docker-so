prefix: /usr/local
components:
    git:
        apt: [git]
    http-client:
        apt: [curl, ca-certificates]
    net-utils:
        apt: [rsync, tcpdump, socat]
        # components
        deps: [network]
        build-deps: []
    websocket:
        http:
        - name: websocat
          version:
              type: github
              repo: vi/websocat
              extract:
              - from-json: null
              - index: tag_name
          download:
              url: https://github.com/vi/websocat/releases/download/{{version}}/websocat.x86_64-unknown-linux-musl
          install:
              target: /bin
              rename: websocat
    network:
        apt: [lsof, inetutils-ping, iproute2, iptables, net-tools]
    sys:
        apt: [sudo, procps, htop, cron, tzdata]
    security:
        apt: [openssl]
    utils:
        apt: [sqlite3, jq, patch, tree, logrotate]
        http:
        - name: rg
          version:
              type: github
              repo: BurntSushi/ripgrep
              extract:
              - from-json: null
              - index: tag_name
          download:
              url: https://github.com/BurntSushi/ripgrep/releases/latest/download/ripgrep-{{version}}-x86_64-unknown-linux-musl.tar.gz
          install:
              target: /bin
              strip: 1
              filter:
              - '*/rg'
        - name: fd
          version:
              type: github
              repo: sharkdp/fd
              extract:
              - from-json: null
              - index: tag_name
          download:
              url: https://github.com/sharkdp/fd/releases/latest/download/fd-{{version}}-x86_64-unknown-linux-musl.tar.gz
          install:
              target: /bin
              strip: 1
              filter:
              - '*/fd'
    disk:
        http:
        - name: dust
          version:
              type: github
              repo: bootandy/dust
              extract:
              - from-json: null
              - index: tag_name
          download:
              url: https://github.com/bootandy/dust/releases/latest/download/dust-{{version}}-x86_64-unknown-linux-musl.tar.gz
          install:
              target: /bin
              strip: 1
              filter:
              - '*/dust'
    compress:
        apt: [xz-utils, zstd, zip, unzip]
    tunnel:
        http:
        - name: wstunnel
          version:
              type: github
              repo: erebe/wstunnel
              extract:
              - from-json: null
              - index: tag_name
              - only-nums: null
          download:
              url: https://github.com/erebe/wstunnel/releases/download/v{{version}}/wstunnel_{{version}}_linux_amd64.tar.gz
          install:
              target: /bin
              rename: wstunnel
    quickjs:
        http:
        - name: quickjs
          version:
              type: html
              url: https://bellard.org/quickjs/
              extract:
              - regexp: 'href="quickjs-([0-9\-]+).tar.xz"'
          download:
              url: https://bellard.org/quickjs/binary_releases/quickjs-linux-x86_64-{{version}}.zip
          install:
              target: /bin
              filter:
              - qjs
    neovim:
        http:
        - name: neovim
          version:
              type: github
              repo: 'neovim/neovim'
              extract:
              - from-json: null
              - index: name
              - only-nums: null
          download:
              url: https://github.com/neovim/neovim/releases/latest/download/nvim-linux64.tar.gz
              filename: nvim-{{version}}-linux64.tar.gz
          install:
              strip: 1
              target: /

    neovim-config:
        build-deps: [git]
        flow:
        - pipeline:
          - type: git
            url: https://github.com/fj0r/nvim-lua.git
            dist: ~/.config/nvim
          - type: cmd
            cmd:
            - nvim --headless "+Lazy! sync" +qa
    rust:
        http:
        - name: cargo
          version:
              type: html
          packages:
            - tokio
    bootstrap:
        shell:
        - name: bootstrap




layers:
    test-deps:
    - net-utils
    bootstrap:
    - bootstrap
    neovim:
    - neovim
    neovim-config:
    - neovim-config
    neovim-full:
    - neovim
    - neovim-config
    base:
    - http-client
    - net-utils
    - websocket
    - network
    - sys
    - security
    - utils
    - disk
    - compress
    - tunnel
    - quickjs

